# ============================================
# LifeCycle - Docker Compose (快速启动)
# ============================================
# 使用方式:
#   1. 复制 .env.example 为 .env
#   2. 修改环境变量
#   3. docker compose up -d
#
# 如需 Nginx + SSL，请参考 docker-compose.production.yml
# ============================================

services:
  app:
    image: ghcr.io/YOUR_OWNER/lifecycle:latest
    # 如需本地构建，注释上面的 image 行，取消下面的 build 注释:
    # build:
    #   context: .
    #   dockerfile: Dockerfile
    #   args:
    #     - NEXT_PUBLIC_APP_URL=${NEXT_PUBLIC_APP_URL:-http://localhost:3000}
    container_name: lifecycle
    restart: unless-stopped
    ports:
      - "${APP_PORT:-3000}:3000"
    environment:
      # ---- 数据库 ----
      - DATABASE_PROVIDER=${DATABASE_PROVIDER:-sqlite}
      - DATABASE_URL=file:/app/data/lifecycle.db
      # Turso (仅 DATABASE_PROVIDER=turso 时需要)
      - TURSO_DATABASE_URL=${TURSO_DATABASE_URL:-}
      - TURSO_AUTH_TOKEN=${TURSO_AUTH_TOKEN:-}
      # ---- 认证 ----
      - BETTER_AUTH_SECRET=${BETTER_AUTH_SECRET}
      - BETTER_AUTH_URL=${BETTER_AUTH_URL:-http://localhost:3000}
      - NEXT_PUBLIC_APP_URL=${NEXT_PUBLIC_APP_URL:-http://localhost:3000}
      # ---- 定时任务 ----
      - CRON_SECRET=${CRON_SECRET:-}
      - CRON_ENABLED=${CRON_ENABLED:-true}
      - CRON_SCHEDULE=${CRON_SCHEDULE:-0 9 * * *}
      - CRON_TIMEZONE=${CRON_TIMEZONE:-Asia/Shanghai}
    volumes:
      - lifecycle-data:/app/data

volumes:
  lifecycle-data:
    name: lifecycle-data
